<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shop | Mall SKS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<style>
body{
    font-family: Arial, sans-serif;
    margin:0;
}

/* TOP BAR */
.shop-topbar{
    display:flex;
    align-items:center;
    gap:15px;
    padding:15px 20px;
    font-size:22px;
    font-weight:bold;
    width: 100%;
}

/* FILTER ICON */
.filter-toggle{
    font-size:26px;
    cursor:pointer;
    background:#eee;
    padding:6px 12px;
    border-radius:8px;

    position: relative;   /* üî• ADD */
    z-index: 100000;      /* üî• ADD */
}

/* LAYOUT */
.shop-layout{
    display: flex;
    position: relative;
    z-index: 1;
}
/* ===== FILTER SIDEBAR ===== */
.filters{
    width:260px;
    background:#fff;
    padding:20px;
   
    position: fixed;
    top:80px;              /* üî• header height */
    left:0;
    height:calc(100vh - 80px);

    transform: translateX(-100%);
    transition: transform 0.3s ease;

    z-index:9999;
}

.filters.active{
    transform: translateX(0);
}
@media (min-width: 992px){

    .filters{
        position: static;
        height:auto;
        left:0;
    }

    .shop-layout{
        display:flex;
        gap:20px;
        padding:20px;
    }

    .products{
        flex:1;
        grid-template-columns: repeat(4,1fr);
    }
}
/* MOBILE FIX */

/* FILTER SECTION */
.filter-section{
    margin-bottom:20px;
    border-bottom:1px solid #eee;
    padding-bottom:15px;
}

.filter-section h4{
    font-size:16px;
    font-weight:600;
    margin-bottom:10px;
    cursor:pointer;
}

/* OPTIONS */
.filter-section a{
    display:block;
    padding:6px 0;
    text-decoration:none;
    color:#333;
    transition:0.2s;
}

.filter-section a:hover{
    color:#ff4d8d;
    padding-left:5px;
}

/* FILTER TREE */
.sub-box{
    display:none;
    margin-left:10px;
}

.sub-box-inner{
    display:none;
    margin-left:15px;
}

.sub-box a{
    display:block;
    padding:6px 0;
    text-decoration:none;
    color:black;
}

.sub-box p{
    cursor:pointer;
    margin:5px 0;
}
.home-shop{
    display:flex;
    align-items:flex-start;
}
/* PRODUCTS GRID */
.products{
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    padding: 10px;
    width: 100%;
    box-sizing:border-box;
}


.card{
    background:white;
    border-radius:12px;
    padding:12px;
    box-shadow:0 0 10px rgba(0,0,0,0.08);
    text-align:center;
    width:100%;
    max-width:100%;
}

.card img{
    width:100%;
    height:220px;
    object-fit:cover;
    border-radius:10px;
     
    max-width:100%;
}

/* MOBILE FIX */



/* DESKTOP */
@media (min-width: 992px) {
    .products {
        grid-template-columns: repeat(4, 1fr);
    }
}
</style>
</head>

<body>

{% include "header.html" %}

<!-- TOP BAR -->
<div class="shop-topbar">
    <div class="filter-toggle" >‚ò∞</div>
 
    Filters

  
</div>


<div class="shop-layout">
    

<!-- ================= FILTER SIDEBAR ================= -->
<div class="filters" id="filterBox">

<!-- ===== HOME ===== -->
{% if page == "home" %}

<div class="filter-section">
  <h4>Categories</h4>

  <a href="/category/men">Men</a>
  <a href="/category/women">Women</a>
  <a href="/category/kids">Kids</a>

</div>

{% endif %}


<!-- ===== MEN ===== -->
{% if page == "men" %}
<div class="filter-section">
  <h4 onclick="toggleSection('menBox')">Men ‚ñæ</h4>

  <div id="menBox" class="sub-box" style="display:block;">

    <p onclick="toggleSection('shirtBox')">Shirts ‚ñ∏</p>
    <div id="shirtBox" class="sub-box-inner">
  <a href="/category/men?type=shirt&brand=ramraj">Ramraj</a>
  <a href="/category/men?type=shirt&brand=coolcolours">Coolcolours</a>
  <a href="/category/men?type=shirt&brand=whitehouse">White House</a>
  <a href="/category/men?type=shirt&brand=red_white">Red & White</a>
  <a href="/category/men?type=shirt&brand=oyemberg">Oyemberg</a>
</div>

    <p><a href="/category/men?type=tshirt">T-Shirts</a></p>
    <p><a href="/category/men?type=jeans">Jeans</a></p>
    <p><a href="/category/men?type=Cotton pants">Cotton Pants</a></p>
    <p><a href="/category/men?type=Night Wear">Night Wear</a></p>

  </div>
    <select id="sortSelect" onchange="sortProducts()">
        <option value="">Sort</option>
        <option value="low">Price: Low ‚Üí High</option>
        <option value="high">Price: High ‚Üí Low</option>
    </select>
</div>
{% endif %}


<!-- ===== WOMEN ===== -->
{% if page == "women" %}
<div class="filter-section">
  <h4 onclick="toggleSection('womenBox')">Women ‚ñæ</h4>

  <div id="womenBox" class="sub-box" style="display:block;">

    <p onclick="toggleSection('sareeBox')">Sarees ‚ñ∏</p>
    <div id="sareeBox" class="sub-box-inner">
        <a href="{{ url_for('category', name='women', type='saree', brand='pattusarees') }}">Pattu Sarees</a>

<a href="{{ url_for('category', name='women', type='saree', brand='cottonsarees') }}">Cotton Sarees</a>

<a href="{{ url_for('category', name='women', type='saree', brand='fancysarees') }}">Fancy Sarees</a>

<a href="{{ url_for('category', name='women', type='saree', brand='syntheticsarees') }}">Synthetic Sarees</a>
   
    </div>

    <<p><a href="{{ url_for('category', name='women', type='kurti') }}">Kurties</a></p>

<p><a href="{{ url_for('category', name='women', type='legging') }}">Leggings</a></p>

<p><a href="{{ url_for('category', name='women', type='chudidar') }}">Chudidars</a></p>

<p><a href="{{ url_for('category', name='women', type='croptop') }}">Crop Tops</a></p>

<p><a href="{{ url_for('category', name='women', type='innerwear') }}">InnerWear</a></p>

<p><a href="{{ url_for('category', name='women', type='nighty') }}">Nighty</a></p>

  </div>
    <select id="sortSelect" onchange="sortProducts()">
        <option value="">Sort</option>
        <option value="low">Price: Low ‚Üí High</option>
        <option value="high">Price: High ‚Üí Low</option>
    </select>
</div>
{% endif %}


<!-- ===== KIDS ===== -->
{% if page == "kids" %}
<div class="filter-section">
  <h4 onclick="toggleSection('kidsBox')">Kids ‚ñæ</h4>

  <div id="kidsBox" class="sub-box" style="display:block;">

    <p onclick="toggleSection('boysBox')">Boys ‚ñ∏</p>
    <div id="boysBox" class="sub-box-inner">
      <a href="{{ url_for('category', name='kids', type='boys', brand='partywear') }}">Party Wear</a>
      <a href="{{ url_for('category', name='kids', type='boys', brand='nightdress') }}">Night Dress</a>
    </div>

    <p onclick="toggleSection('girlsBox')">Girls ‚ñ∏</p>
    <div id="girlsBox" class="sub-box-inner">
      <a href="{{ url_for('category', name='kids', type='girls', brand='partywear') }}">Party Wear</a>
      <a href="{{ url_for('category', name='kids', type='girls', brand='nightdress') }}">Night Dress</a>
    </div>

    <p>
      <a href="{{ url_for('category', name='kids', type='babywear') }}">Baby Wear</a>
    </p>

  </div>
</div>
    <select id="sortSelect" onchange="sortProducts()">
        <option value="">Sort</option>
        <option value="low">Price: Low ‚Üí High</option>
        <option value="high">Price: High ‚Üí Low</option>
    </select>
</div>
{% endif %}











</div>



<!-- ================= PRODUCTS ================= -->
<!-- ================= PRODUCTS ================= -->
<div class="products">

{% for p in products %}
<div class="card" data-price="{{ p.price }}">

    <a href="{{ url_for('product_page', pid=p.id) }}">
        <img src="{{ url_for('static', filename=p.image) }}" class="product-img">
    </a>

    <h4>{{ p.name }}</h4>
    <b>‚Çπ{{ p.price }}</b>

</div>
{% endfor %}

</div>

</div>
<script>
document.addEventListener("DOMContentLoaded", function(){

    const btn = document.querySelector(".filter-toggle");
    const box = document.getElementById("filterBox");
    const topBar = document.querySelector(".shop-topbar"); // üî• ADD

    if(!btn){
        alert("Button not found ‚ùå");
    }

    if(!box){
        alert("Filter box not found ‚ùå");
    }

    // ‚úÖ CLICK EVENT
    btn.onclick = function(e){
        e.stopPropagation();

        box.classList.toggle("active");
        console.log("clicked ‚úÖ");

        // üî• TOP BAR HIDE/SHOW
        if(box.classList.contains("active")){
            topBar.style.display = "none";
        } else {
            topBar.style.display = "flex";
        }
    };

    // ‚úÖ OUTSIDE CLICK CLOSE
    document.onclick = function(e){
        if(box.classList.contains("active") && !box.contains(e.target) && !btn.contains(e.target)){
            box.classList.remove("active");

            // üî• BACK TO NORMAL
            topBar.style.display = "flex";
        }
    };

});
function toggleSection(id){
    const box = document.getElementById(id);

    if(box.style.display === "block"){
        box.style.display = "none";
    } else {
        box.style.display = "block";
    }
}
function sortProducts(){
    let select = document.getElementById("sortSelect").value;
    let productsContainer = document.querySelector(".products");
    let products = Array.from(document.querySelectorAll(".product-card"));

    products.sort(function(a, b){
        let priceA = parseFloat(a.getAttribute("data-price"));
        let priceB = parseFloat(b.getAttribute("data-price"));

        if(select === "low"){
            return priceA - priceB;
        }
        else if(select === "high"){
            return priceB - priceA;
        }
        else{
            return 0;
        }
    });

    products.forEach(function(product){
        productsContainer.appendChild(product);
    });
}
</script>
{% include "footer.html" %}

</body>
</html>
